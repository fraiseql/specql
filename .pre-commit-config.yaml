# Pre-commit hooks for SpecQL
# See https://pre-commit.com for more information
# Install: pre-commit install
# Run manually: pre-commit run --all-files

repos:
  # Ruff - Fast Python linter and formatter (replaces flake8, isort, black)
- repo: https://github.com/astral-sh/ruff-pre-commit
  rev: v0.14.5
  hooks:
      # Run the linter
  - id: ruff
    args: [--fix]
      # Run the formatter
  - id: ruff-format

  # Standard pre-commit hooks
- repo: https://github.com/pre-commit/pre-commit-hooks
  rev: v5.0.0
  hooks:
  - id: trailing-whitespace
  - id: end-of-file-fixer
    exclude: ^tests/integration/stdlib/snapshots/.*\.sql$  # Snapshots match generated DDL format
  - id: check-yaml
    args: [--unsafe]      # Allow custom YAML tags
    exclude: ^stdlib/actions/temporal/non_overlapping_daterange\.yaml$  # Jinja2 template
  - id: check-json
  - id: check-toml
  - id: check-added-large-files
    args: [--maxkb=1000]
  - id: check-merge-conflict
  - id: debug-statements
  - id: mixed-line-ending
    args: [--fix=lf]

  # YAML formatting
- repo: https://github.com/macisamuele/language-formatters-pre-commit-hooks
  rev: v2.15.0
  hooks:
  - id: pretty-format-yaml
    args: [--autofix, --indent, '2', --preserve-quotes]
    exclude: ^(vendor/|\.github/workflows/|stdlib/actions/temporal/non_overlapping_daterange\.yaml)

# Exclude patterns for all hooks
exclude: |
  (?x)^(
      vendor/.*|
      \.git/.*|
      \.venv/.*|
      __pycache__/.*|
      \.pytest_cache/.*|
      \.ruff_cache/.*|
      archived/.*
  )$

# Global configuration
default_language_version:
  python: python3.11

ci:
  autofix_commit_msg: |
    [pre-commit.ci] auto fixes from pre-commit.com hooks

    for more information, see https://pre-commit.ci
  autofix_prs: true
  autoupdate_branch: ''
  autoupdate_commit_msg: '[pre-commit.ci] pre-commit autoupdate'
  autoupdate_schedule: weekly
  skip: []
  submodules: false
