<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Team T-Seed: Seed Data Generation with UUID Encoding - SpecQL Documentation</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Team T-Seed: Seed Data Generation with UUID Encoding";
        var mkdocs_page_input_path = "implementation-plans/testing-and-seed-generation/02_TEAM_T_SEED.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> SpecQL Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../../getting-started/">Getting Started</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Guides</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../../../guides/mutation-patterns/">Mutation Patterns</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../guides/test-generation/">Test Generation</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../guides/cli/">CLI</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../../reference/">Reference</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../../examples/">Examples</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../../tutorials/">Tutorials</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../../best-practices/">Best Practices</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../../troubleshooting/">Troubleshooting</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">SpecQL Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Team T-Seed: Seed Data Generation with UUID Encoding</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="team-t-seed-seed-data-generation-with-uuid-encoding">Team T-Seed: Seed Data Generation with UUID Encoding</h1>
<p><strong>Status</strong>: Planning Phase
<strong>Timeline</strong>: Week 3 (5 days)
<strong>Priority</strong>: High - Enables integration testing
<strong>Team Size</strong>: 1-2 developers
<strong>Dependencies</strong>: Team T-Meta complete</p>
<hr />
<h2 id="mission">üéØ Mission</h2>
<p><strong>Generate realistic, traceable seed data for SpecQL entities using UUID encoding and group leader pattern.</strong></p>
<p>Seed data must be:
- <strong>Realistic</strong>: Uses Faker for human-readable values
- <strong>Traceable</strong>: UUIDs encode entity/scenario/instance
- <strong>Consistent</strong>: Group leaders ensure related fields match
- <strong>Repeatable</strong>: Same input ‚Üí same output (deterministic)</p>
<hr />
<h2 id="responsibilities">üìã Responsibilities</h2>
<h3 id="core">Core</h3>
<ol>
<li><strong>UUID Generator</strong> - Encode entity/test-type/scenario/instance in UUIDs</li>
<li><strong>Field Value Generator</strong> - Generate values based on type (random, FK, group leader)</li>
<li><strong>Entity Seed Generator</strong> - Complete entity record generation</li>
<li><strong>SQL File Generator</strong> - Output INSERT statements</li>
</ol>
<h3 id="integration">Integration</h3>
<ul>
<li>Consume: Team T-Meta's metadata (entity config, field generators)</li>
<li>Provide: Seed SQL files for Team T-Test, manual testing</li>
<li>Coordinate: Team B for table codes, Team E for CLI</li>
</ul>
<hr />
<h2 id="architecture">üèóÔ∏è Architecture</h2>
<pre><code>Test Metadata (from Team T-Meta)
    ‚Üì
UUID Generator ‚Üí Encoded UUIDs
    ‚Üì
Field Value Generators
    ‚îú‚îÄ Random Generator (Faker)
    ‚îú‚îÄ FK Resolver (query existing records)
    ‚îú‚îÄ Group Leader (atomic multi-field)
    ‚îî‚îÄ Fixed/Sequence
    ‚Üì
Entity Seed Generator
    ‚Üì
SQL INSERT Statements
    ‚Üì
Output: seed/contact_scenario_0.sql
</code></pre>
<hr />
<h2 id="component-1-uuid-generator">üß¨ Component 1: UUID Generator</h2>
<p><strong>File</strong>: <code>src/testing/seed/uuid_generator.py</code></p>
<h3 id="uuid-encoding-pattern">UUID Encoding Pattern</h3>
<pre><code>EEEEETTF-FFFF-0SSS-TTTT-00000000IIII

Parts:
- EEEEEE (6): Entity code (table_code from metadata)
- TT (2): Test type (21=seed, 22=mutation, 23=query)
- F (1): Function number last digit (or 0 for seed)
- FFFF (4): Full function number (or 0000 for seed)
- 0 (1): Reserved
- SSS (3): Scenario code high 3 digits
- TTTT (4): Scenario code low + test case
- 000000000000IIII (12): Instance number
</code></pre>
<h3 id="implementation">Implementation</h3>
<pre><code class="language-python"># src/testing/seed/uuid_generator.py

from uuid import UUID
from dataclasses import dataclass
from typing import Optional

@dataclass
class UUIDComponents:
    &quot;&quot;&quot;Decoded UUID components&quot;&quot;&quot;
    entity_code: str        # &quot;012321&quot;
    test_type: str          # &quot;21&quot;
    function_num: str       # &quot;0000&quot;
    scenario: int           # 1000
    test_case: int          # 0
    instance: int           # 1

    def __str__(self) -&gt; str:
        return (
            f&quot;Entity: {self.entity_code}, &quot;
            f&quot;Type: {self.test_type}, &quot;
            f&quot;Function: {self.function_num}, &quot;
            f&quot;Scenario: {self.scenario}, &quot;
            f&quot;Test: {self.test_case}, &quot;
            f&quot;Instance: {self.instance}&quot;
        )

class SpecQLUUIDGenerator:
    &quot;&quot;&quot;
    Generate encoded UUIDs for SpecQL test data

    Pattern: EEEEETTF-FFFF-0SSS-TTTT-00000000IIII

    Example:
        gen = SpecQLUUIDGenerator.for_entity(&quot;Contact&quot;, entity_code=&quot;012321&quot;)
        uuid = gen.generate(scenario=1000, instance=1)
        # Result: &quot;01232121-0000-0001-0001-000000000001&quot;
    &quot;&quot;&quot;

    # Test type codes
    TEST_TYPES = {
        &quot;general_seed&quot;: &quot;21&quot;,
        &quot;mutation_test&quot;: &quot;22&quot;,
        &quot;query_test&quot;: &quot;23&quot;,
        &quot;staging&quot;: &quot;00&quot;
    }

    def __init__(
        self,
        entity_name: str,
        entity_code: str,  # From metadata: base_uuid_prefix
        test_type: str = &quot;general_seed&quot;,
        function_num: Optional[int] = None
    ):
        self.entity_name = entity_name
        self.entity_code = entity_code.zfill(6)  # Ensure 6 digits
        self.test_type_code = self.TEST_TYPES[test_type]
        self.function_num = function_num

    @classmethod
    def from_metadata(
        cls,
        entity_config: dict,
        test_type: str = &quot;general_seed&quot;
    ) -&gt; 'SpecQLUUIDGenerator':
        &quot;&quot;&quot;Create from test metadata entity config&quot;&quot;&quot;
        return cls(
            entity_name=entity_config['entity_name'],
            entity_code=entity_config['base_uuid_prefix'],
            test_type=test_type
        )

    def generate(
        self,
        scenario: int = 0,
        instance: int = 1,
        test_case: int = 0
    ) -&gt; UUID:
        &quot;&quot;&quot;
        Generate encoded UUID

        Args:
            scenario: Scenario code (0=default, 1000=dedup, 2000=alt, etc.)
            instance: Instance number (sequential: 1, 2, 3...)
            test_case: Test case number (for multiple tests per scenario)

        Returns:
            UUID with encoded components

        Example:
            &gt;&gt;&gt; gen = SpecQLUUIDGenerator(&quot;Contact&quot;, &quot;012321&quot;)
            &gt;&gt;&gt; str(gen.generate(scenario=1000, instance=5))
            '01232121-0000-0001-0005-000000000005'
        &quot;&quot;&quot;
        # Part 1: EEEEETTF (8 hex chars)
        function_digit = &quot;0&quot;
        if self.function_num:
            function_digit = str(self.function_num)[-1]

        part1 = f&quot;{self.entity_code}{self.test_type_code}{function_digit}&quot;

        # Part 2: FFFF (4 hex chars)
        if self.function_num:
            func_str = str(self.function_num).zfill(4)[-4:]
        else:
            func_str = &quot;0000&quot;
        part2 = func_str

        # Part 3: 0SSS (4 hex chars) - Reserved + scenario high digit
        scenario_str = str(scenario).zfill(4)
        part3 = f&quot;0{scenario_str[0:3]}&quot;

        # Part 4: TTTT (4 hex chars) - Scenario low + test case
        part4 = f&quot;{scenario_str[3]}{str(test_case).zfill(3)}&quot;

        # Part 5: 00000000IIII (12 hex chars)
        part5 = str(instance).zfill(12)

        uuid_str = f&quot;{part1}-{part2}-{part3}-{part4}-{part5}&quot;
        return UUID(uuid_str)

    def generate_batch(
        self,
        count: int,
        scenario: int = 0,
        start_instance: int = 1
    ) -&gt; list[UUID]:
        &quot;&quot;&quot;Generate batch of UUIDs with sequential instances&quot;&quot;&quot;
        return [
            self.generate(scenario=scenario, instance=start_instance + i)
            for i in range(count)
        ]

    @staticmethod
    def decode(uuid: UUID) -&gt; UUIDComponents:
        &quot;&quot;&quot;
        Decode UUID into components

        Example:
            &gt;&gt;&gt; components = SpecQLUUIDGenerator.decode(
            ...     UUID(&quot;01232122-3201-0001-0001-000000000001&quot;)
            ... )
            &gt;&gt;&gt; components.entity_code
            '012321'
            &gt;&gt;&gt; components.scenario
            1000
        &quot;&quot;&quot;
        s = str(uuid).replace('-', '')

        return UUIDComponents(
            entity_code=s[0:6],
            test_type=s[6:8],
            function_num=s[9:13],
            scenario=int(s[14:17] + s[18:21]),
            test_case=int(s[21:24]),
            instance=int(s[24:36])
        )
</code></pre>
<h3 id="tests">Tests</h3>
<pre><code class="language-python"># tests/unit/testing/test_uuid_generator.py

def test_generate_basic_uuid():
    gen = SpecQLUUIDGenerator(&quot;Contact&quot;, &quot;012321&quot;)
    uuid = gen.generate(scenario=0, instance=1)

    assert str(uuid) == &quot;01232121-0000-0000-0000-000000000001&quot;

def test_generate_scenario_1000():
    gen = SpecQLUUIDGenerator(&quot;Contact&quot;, &quot;012321&quot;)
    uuid = gen.generate(scenario=1000, instance=1)

    # Scenario 1000 ‚Üí 0001-0001
    assert str(uuid) == &quot;01232121-0000-0001-0001-000000000001&quot;

def test_decode_uuid():
    uuid = UUID(&quot;01232122-3201-0001-0005-000000000042&quot;)
    components = SpecQLUUIDGenerator.decode(uuid)

    assert components.entity_code == &quot;012321&quot;
    assert components.test_type == &quot;22&quot;
    assert components.function_num == &quot;3201&quot;
    assert components.scenario == 1000
    assert components.test_case == 5
    assert components.instance == 42

def test_generate_batch():
    gen = SpecQLUUIDGenerator(&quot;Contact&quot;, &quot;012321&quot;)
    uuids = gen.generate_batch(count=3, scenario=2000)

    assert len(uuids) == 3
    assert uuids[0] == UUID(&quot;01232121-0000-0002-0001-000000000001&quot;)
    assert uuids[1] == UUID(&quot;01232121-0000-0002-0002-000000000002&quot;)
    assert uuids[2] == UUID(&quot;01232121-0000-0002-0003-000000000003&quot;)
</code></pre>
<hr />
<h2 id="component-2-field-value-generators">üå± Component 2: Field Value Generators</h2>
<p><strong>File</strong>: <code>src/testing/seed/field_generators.py</code></p>
<h3 id="random-value-generator-with-faker">Random Value Generator (with Faker)</h3>
<pre><code class="language-python"># src/testing/seed/field_generators.py

from faker import Faker
import random
from typing import Any, Dict, Optional

class FieldValueGenerator:
    &quot;&quot;&quot;Generate field values based on type and metadata&quot;&quot;&quot;

    def __init__(self, seed: Optional[int] = None):
        &quot;&quot;&quot;
        Args:
            seed: Random seed for deterministic generation
        &quot;&quot;&quot;
        self.faker = Faker()
        if seed:
            Faker.seed(seed)
            random.seed(seed)

    def generate(
        self,
        field_mapping: Dict[str, Any],
        context: Dict[str, Any] = None
    ) -&gt; Any:
        &quot;&quot;&quot;
        Generate value for field based on mapping

        Args:
            field_mapping: From test_metadata.tb_field_generator_mapping
            context: Previously generated field values (for dependencies)

        Returns:
            Generated value (type depends on field)
        &quot;&quot;&quot;
        generator_type = field_mapping['generator_type']

        if generator_type == 'random':
            return self._generate_random(field_mapping)
        elif generator_type == 'fixed':
            return field_mapping['generator_params']['fixed_value']
        elif generator_type == 'sequence':
            return self._generate_sequence(field_mapping, context)
        else:
            raise ValueError(f&quot;Unsupported generator type: {generator_type}&quot;)

    def _generate_random(self, mapping: Dict[str, Any]) -&gt; Any:
        &quot;&quot;&quot;Generate random value based on field type&quot;&quot;&quot;
        field_type = mapping['field_type']

        # Use example values if provided
        if mapping.get('example_values'):
            return random.choice(mapping['example_values'])

        # Rich scalar types
        if field_type == 'email':
            return self.faker.email()

        elif field_type == 'phoneNumber':
            return self.faker.phone_number()

        elif field_type == 'url':
            return self.faker.url()

        elif field_type == 'money':
            return round(random.uniform(10, 10000), 2)

        elif field_type == 'percentage':
            return round(random.uniform(0, 100), 2)

        elif field_type == 'ipAddress':
            return self.faker.ipv4()

        elif field_type == 'macAddress':
            return self.faker.mac_address()

        # Basic types
        elif field_type == 'text':
            return self.faker.sentence(nb_words=3).rstrip('.')

        elif field_type == 'integer':
            dist = mapping.get('seed_distribution', {})
            min_val = dist.get('min', 1)
            max_val = dist.get('max', 1000)
            return random.randint(min_val, max_val)

        elif field_type == 'boolean':
            return random.choice([True, False])

        elif field_type.startswith('enum('):
            # Parse: &quot;enum(lead, qualified, customer)&quot; ‚Üí [&quot;lead&quot;, &quot;qualified&quot;, &quot;customer&quot;]
            if mapping.get('enum_values'):
                values = mapping['enum_values']
            else:
                values = field_type[5:-1].split(',')
                values = [v.strip() for v in values]
            return random.choice(values)

        elif field_type == 'date':
            return self.faker.date_between(start_date='-1y', end_date='today')

        elif field_type == 'timestamptz':
            return self.faker.date_time_between(start_date='-1y', end_date='now')

        else:
            # Fallback
            return None

    def _generate_sequence(self, mapping: Dict, context: Dict) -&gt; Any:
        &quot;&quot;&quot;Generate sequential value&quot;&quot;&quot;
        params = mapping.get('generator_params', {})
        start = params.get('start', 1)
        step = params.get('step', 1)
        instance_num = context.get('instance_num', 1)

        return start + (instance_num - 1) * step
</code></pre>
<h3 id="tests_1">Tests</h3>
<pre><code class="language-python"># tests/unit/testing/test_field_generators.py

def test_generate_email():
    gen = FieldValueGenerator(seed=42)  # Deterministic
    mapping = {'field_type': 'email', 'generator_type': 'random'}

    email = gen.generate(mapping)
    assert '@' in email
    assert '.' in email

def test_generate_enum():
    gen = FieldValueGenerator(seed=42)
    mapping = {
        'field_type': 'enum(lead, qualified, customer)',
        'generator_type': 'random'
    }

    status = gen.generate(mapping)
    assert status in ['lead', 'qualified', 'customer']

def test_generate_from_examples():
    gen = FieldValueGenerator(seed=42)
    mapping = {
        'field_type': 'text',
        'generator_type': 'random',
        'example_values': ['red', 'green', 'blue']
    }

    color = gen.generate(mapping)
    assert color in ['red', 'green', 'blue']
</code></pre>
<hr />
<h2 id="component-3-fk-resolver-group-leader">üîó Component 3: FK Resolver &amp; Group Leader</h2>
<p><strong>File</strong>: <code>src/testing/seed/fk_resolver.py</code></p>
<pre><code class="language-python"># src/testing/seed/fk_resolver.py

from typing import Any, Dict, List, Optional
import psycopg

class ForeignKeyResolver:
    &quot;&quot;&quot;Resolve foreign key values by querying database&quot;&quot;&quot;

    def __init__(self, db_connection: psycopg.Connection):
        self.db = db_connection

    def resolve(
        self,
        field_mapping: Dict[str, Any],
        context: Dict[str, Any]
    ) -&gt; Optional[int]:
        &quot;&quot;&quot;
        Resolve FK value by querying target table

        Returns:
            INTEGER pk value from target table
        &quot;&quot;&quot;
        # Check dependencies satisfied
        dependencies = field_mapping.get('fk_dependencies', [])
        for dep in dependencies:
            if dep not in context:
                raise ValueError(f&quot;FK dependency not satisfied: {dep}&quot;)

        # Use custom query if provided
        if field_mapping.get('fk_resolution_query'):
            query = field_mapping['fk_resolution_query']
            # Replace placeholders
            for key, value in context.items():
                if isinstance(value, str):
                    query = query.replace(f&quot;${key}&quot;, f&quot;'{value}'&quot;)
                else:
                    query = query.replace(f&quot;${key}&quot;, str(value))
        else:
            # Default: random selection from target table
            query = self._build_default_query(field_mapping, context)

        result = self.db.execute(query).fetchone()
        return result[0] if result else None

    def _build_default_query(self, mapping: Dict, context: Dict) -&gt; str:
        &quot;&quot;&quot;Build default FK resolution query&quot;&quot;&quot;
        schema = mapping['fk_target_schema']
        table = mapping['fk_target_table']
        pk_field = mapping['fk_target_pk_field']

        query = f&quot;SELECT {pk_field} FROM {schema}.{table} WHERE deleted_at IS NULL&quot;

        # Add tenant filter if tenant-scoped
        if 'tenant_id' in context:
            query += f&quot; AND tenant_id = '{context['tenant_id']}'&quot;

        # Add custom filter conditions
        if mapping.get('fk_filter_conditions'):
            query += f&quot; AND {mapping['fk_filter_conditions']}&quot;

        query += &quot; ORDER BY RANDOM() LIMIT 1&quot;

        return query


class GroupLeaderExecutor:
    &quot;&quot;&quot;Execute group leader queries to get multiple related field values&quot;&quot;&quot;

    def __init__(self, db_connection: psycopg.Connection):
        self.db = db_connection

    def execute(
        self,
        leader_mapping: Dict[str, Any],
        context: Dict[str, Any]
    ) -&gt; Dict[str, Any]:
        &quot;&quot;&quot;
        Execute group leader query, return all dependent field values

        Returns:
            Dict mapping field names to values
            Example: {'country_code': 'FR', 'postal_code': '75001', 'city_code': 'PAR'}
        &quot;&quot;&quot;
        query = leader_mapping['generator_params']['leader_query']
        dependent_fields = leader_mapping['group_dependency_fields']

        result = self.db.execute(query).fetchone()

        if not result:
            raise ValueError(f&quot;Group leader query returned no results: {query}&quot;)

        # Map result columns to dependent field names
        return dict(zip(dependent_fields, result))
</code></pre>
<hr />
<h2 id="component-4-entity-seed-generator">üè≠ Component 4: Entity Seed Generator</h2>
<p><strong>File</strong>: <code>src/testing/seed/seed_generator.py</code></p>
<pre><code class="language-python"># src/testing/seed/seed_generator.py

from typing import Dict, List, Any
from .uuid_generator import SpecQLUUIDGenerator
from .field_generators import FieldValueGenerator
from .fk_resolver import ForeignKeyResolver, GroupLeaderExecutor

class EntitySeedGenerator:
    &quot;&quot;&quot;Generate complete entity records with all fields&quot;&quot;&quot;

    def __init__(
        self,
        entity_config: Dict[str, Any],
        field_mappings: List[Dict[str, Any]],
        db_connection=None,
        seed: int = None
    ):
        self.config = entity_config
        self.field_mappings = sorted(field_mappings, key=lambda x: x['priority_order'])

        self.uuid_gen = SpecQLUUIDGenerator.from_metadata(entity_config)
        self.field_gen = FieldValueGenerator(seed=seed)

        if db_connection:
            self.fk_resolver = ForeignKeyResolver(db_connection)
            self.group_leader = GroupLeaderExecutor(db_connection)
        else:
            self.fk_resolver = None
            self.group_leader = None

    def generate(
        self,
        scenario: int = 0,
        instance: int = 1,
        overrides: Dict[str, Any] = None
    ) -&gt; Dict[str, Any]:
        &quot;&quot;&quot;
        Generate complete entity record

        Returns:
            Dict with all field values
        &quot;&quot;&quot;
        entity_data = {}
        context = {'instance_num': instance}

        # Generate UUID first
        entity_data['id'] = self.uuid_gen.generate(scenario=scenario, instance=instance)
        context['id'] = entity_data['id']

        # Add tenant context
        if self.config['is_tenant_scoped']:
            entity_data['tenant_id'] = self.config['default_tenant_id']
            context['tenant_id'] = entity_data['tenant_id']

        # Process fields in dependency order
        for mapping in self.field_mappings:
            field_name = mapping['field_name']

            # Skip if overridden
            if overrides and field_name in overrides:
                entity_data[field_name] = overrides[field_name]
                context[field_name] = overrides[field_name]
                continue

            # Skip group dependents (handled by leader)
            if mapping['generator_type'] == 'group_dependent':
                continue

            # Generate value
            value = self._generate_field_value(mapping, context)

            # Group leader returns multiple values
            if isinstance(value, dict):
                entity_data.update(value)
                context.update(value)
            else:
                entity_data[field_name] = value
                context[field_name] = value

        return entity_data

    def _generate_field_value(self, mapping: Dict, context: Dict) -&gt; Any:
        &quot;&quot;&quot;Generate value for single field&quot;&quot;&quot;

        gen_type = mapping['generator_type']

        if gen_type in ('random', 'fixed', 'sequence'):
            return self.field_gen.generate(mapping, context)

        elif gen_type == 'fk_resolve':
            if not self.fk_resolver:
                raise ValueError(&quot;FK resolution requires database connection&quot;)
            return self.fk_resolver.resolve(mapping, context)

        elif gen_type == 'group_leader':
            if not self.group_leader:
                raise ValueError(&quot;Group leader requires database connection&quot;)
            return self.group_leader.execute(mapping, context)

        else:
            raise ValueError(f&quot;Unknown generator type: {gen_type}&quot;)

    def generate_batch(
        self,
        count: int,
        scenario: int = 0,
        overrides: Dict[str, Any] = None
    ) -&gt; List[Dict[str, Any]]:
        &quot;&quot;&quot;Generate batch of entity records&quot;&quot;&quot;
        return [
            self.generate(scenario=scenario, instance=i+1, overrides=overrides)
            for i in range(count)
        ]
</code></pre>
<hr />
<h2 id="component-5-sql-file-generator">üìÑ Component 5: SQL File Generator</h2>
<p><strong>File</strong>: <code>src/testing/seed/sql_generator.py</code></p>
<pre><code class="language-python"># src/testing/seed/sql_generator.py

from typing import List, Dict, Any
from datetime import datetime
from uuid import UUID

class SeedSQLGenerator:
    &quot;&quot;&quot;Generate SQL INSERT statements from entity data&quot;&quot;&quot;

    def __init__(self, entity_config: Dict[str, Any]):
        self.config = entity_config
        self.schema = entity_config['schema_name']
        self.table = entity_config['table_name']

    def generate_insert(self, entity_data: Dict[str, Any]) -&gt; str:
        &quot;&quot;&quot;Generate single INSERT statement&quot;&quot;&quot;
        columns = []
        values = []

        for field, value in entity_data.items():
            columns.append(field)
            values.append(self._format_value(value))

        cols_str = ', '.join(columns)
        vals_str = ', '.join(values)

        return f&quot;INSERT INTO {self.schema}.{self.table} ({cols_str}) VALUES ({vals_str});&quot;

    def generate_file(
        self,
        entities: List[Dict[str, Any]],
        scenario: int = 0,
        description: str = None
    ) -&gt; str:
        &quot;&quot;&quot;Generate complete SQL file with multiple INSERTs&quot;&quot;&quot;
        lines = [
            f&quot;-- Seed data for {self.config['entity_name']}&quot;,
            f&quot;-- Schema: {self.schema}&quot;,
            f&quot;-- Scenario: {scenario} ({description or 'default'})&quot;,
            f&quot;-- Generated: {datetime.now().isoformat()}&quot;,
            f&quot;-- Record count: {len(entities)}&quot;,
            &quot;&quot;,
        ]

        for entity_data in entities:
            lines.append(self.generate_insert(entity_data))

        lines.append(&quot;&quot;)  # Trailing newline

        return '\n'.join(lines)

    def _format_value(self, value: Any) -&gt; str:
        &quot;&quot;&quot;Format Python value as SQL literal&quot;&quot;&quot;
        if value is None:
            return &quot;NULL&quot;
        elif isinstance(value, UUID):
            return f&quot;'{value}'&quot;
        elif isinstance(value, str):
            # Escape single quotes
            escaped = value.replace(&quot;'&quot;, &quot;''&quot;)
            return f&quot;'{escaped}'&quot;
        elif isinstance(value, bool):
            return &quot;TRUE&quot; if value else &quot;FALSE&quot;
        elif isinstance(value, (int, float)):
            return str(value)
        elif isinstance(value, datetime):
            return f&quot;'{value.isoformat()}'&quot;
        else:
            return f&quot;'{value}'&quot;
</code></pre>
<hr />
<h2 id="testing-strategy">üß™ Testing Strategy</h2>
<h3 id="unit-tests">Unit Tests</h3>
<pre><code class="language-python"># tests/unit/testing/

test_uuid_generator.py              # UUID encoding/decoding
test_field_generators.py            # Random value generation
test_seed_generator.py              # Entity generation (no DB)
test_sql_generator.py               # SQL formatting
</code></pre>
<h3 id="integration-tests">Integration Tests</h3>
<pre><code class="language-python"># tests/integration/testing/

test_fk_resolution.py               # FK resolution with real DB
test_group_leader.py                # Group leader queries
test_full_seed_generation.py        # End-to-end Contact seed
</code></pre>
<hr />
<h2 id="success-criteria">üìä Success Criteria</h2>
<h3 id="week-3-completion">Week 3 Completion</h3>
<ul>
<li>‚úÖ UUID generator with encode/decode</li>
<li>‚úÖ Field value generators for all 23 scalar types</li>
<li>‚úÖ FK resolver querying database</li>
<li>‚úÖ Group leader pattern working</li>
<li>‚úÖ EntitySeedGenerator producing valid records</li>
<li>‚úÖ SQL file generator outputting valid INSERT statements</li>
<li>‚úÖ Generate 100 Contact records in &lt; 1 second</li>
<li>‚úÖ 20+ unit tests passing</li>
<li>‚úÖ 5+ integration tests passing</li>
</ul>
<hr />
<h2 id="example-output">üìù Example Output</h2>
<pre><code class="language-sql">-- Seed data for Contact
-- Schema: crm
-- Scenario: 0 (default seed data)
-- Generated: 2025-11-08T14:30:00
-- Record count: 10

INSERT INTO crm.tb_contact (id, tenant_id, email, first_name, last_name, fk_company, status, country_code, postal_code, city_code) VALUES ('01232121-0000-0000-0001-000000000001', '22222222-2222-2222-2222-222222222222', 'alice.smith@example.com', 'Alice', 'Smith', 15, 'lead', 'FR', '75001', 'PAR');
INSERT INTO crm.tb_contact (id, tenant_id, email, first_name, last_name, fk_company, status, country_code, postal_code, city_code) VALUES ('01232121-0000-0000-0002-000000000002', '22222222-2222-2222-2222-222222222222', 'bob.jones@example.com', 'Bob', 'Jones', 23, 'qualified', 'US', '10001', 'NYC');
-- ... 8 more records
</code></pre>
<hr />
<p><strong>Next</strong>: <a href="../03_TEAM_T_TEST/">Team T-Test: Test Suite Generation</a></p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
