<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Team E: Next Actions Summary - SpecQL Documentation</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Team E: Next Actions Summary";
        var mkdocs_page_input_path = "archive/plans/TEAM_E_NEXT_ACTIONS.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> SpecQL Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../../getting-started/">Getting Started</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Guides</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../../../guides/mutation-patterns/">Mutation Patterns</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../guides/test-generation/">Test Generation</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../guides/cli/">CLI</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../../reference/">Reference</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../../examples/">Examples</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../../tutorials/">Tutorials</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../../best-practices/">Best Practices</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../../troubleshooting/">Troubleshooting</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">SpecQL Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Team E: Next Actions Summary</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="team-e-next-actions-summary">Team E: Next Actions Summary</h1>
<p><strong>Date</strong>: November 9, 2025
<strong>Current Status</strong>: 70% Complete (Phase 3.2 Done)
<strong>Next Phase</strong>: 3.3 - FraiseQL Annotation Cleanup</p>
<hr />
<h2 id="quick-summary">üéØ Quick Summary</h2>
<p><strong>Good News</strong>: Team E is <strong>70% done</strong> - way ahead of original schedule!
- ‚úÖ Confiture integration working
- ‚úÖ Directory structure created
- ‚úÖ CLI commands functional</p>
<p><strong>Important Discovery</strong>: Found ticket requiring FraiseQL annotation cleanup
- Core layer functions shouldn't have <code>@fraiseql:mutation</code> annotations
- Only app layer functions should have them
- ~4 hours of work</p>
<p><strong>Remaining Work</strong>: 40 hours (5 days)
- Annotation cleanup: 4h
- Documentation: 6h
- Frontend codegen: 20h
- Polish: 10h</p>
<hr />
<h2 id="immediate-next-steps-this-week">üöÄ Immediate Next Steps (This Week)</h2>
<h3 id="action-1-fix-fraiseql-annotations-4-hours-high-priority"><strong>Action 1: Fix FraiseQL Annotations</strong> (4 hours - HIGH PRIORITY)</h3>
<p><strong>Problem</strong>: Core functions have <code>@fraiseql:mutation</code> when they shouldn't</p>
<p><strong>Example of Issue</strong>:</p>
<pre><code class="language-sql">-- ‚ùå WRONG: Core function with GraphQL annotation
COMMENT ON FUNCTION crm.create_contact IS
  '@fraiseql:mutation
   name=createContact
   ...';  -- This suggests it's GraphQL-exposed, but it's internal!

-- ‚úÖ CORRECT: Core function with descriptive comment
COMMENT ON FUNCTION crm.create_contact IS
'Core business logic for creating Contact records.
...
Called by: app.create_contact (GraphQL mutation)';
</code></pre>
<p><strong>What to Do</strong>:</p>
<ol>
<li><strong>Update Code Generator</strong> (2h)
   ```bash
   # Edit the file that generates mutation comments
   vim src/generators/fraiseql/mutation_annotator.py</li>
</ol>
<p># Make it generate TWO different comments:
   # - app.<em> functions: @fraiseql:mutation annotation ‚úÖ
   # - schema.</em> functions: descriptive comment only ‚úÖ
   ```</p>
<ol>
<li><strong>Regenerate SQL</strong> (1h)
   ```bash
   # Regenerate all entities with fixed logic
   python -m src.cli.generate entities/examples/*.yaml</li>
</ol>
<p># Verify changes
   git diff db/schema/30_functions/
   ```</p>
<ol>
<li><strong>Manual Cleanup</strong> (30min)
   ```bash
   # Find any remaining issues
   grep -r "@fraiseql:mutation" db/schema/30_functions/ | grep -v "app."</li>
</ol>
<p># Manually fix each file if needed
   ```</p>
<ol>
<li><strong>Verify</strong> (30min)
   ```bash
   # Test 1: Core functions should NOT have annotations
   grep -r "@fraiseql:mutation" db/schema/30_functions/ | grep -v "app."
   # Expected: No results</li>
</ol>
<p># Test 2: App functions SHOULD have annotations
   grep -r "@fraiseql:mutation" db/schema/30_functions/ | grep "app."
   # Expected: All app.* functions</p>
<p># Test 3: Run tests
   uv run pytest tests/ -v
   ```</p>
<p><strong>Reference</strong>: <code>docs/TICKET_REMOVE_FRAISEQL_ANNOTATIONS_FROM_CORE_FUNCTIONS.md</code></p>
<hr />
<h3 id="action-2-update-documentation-6-hours"><strong>Action 2: Update Documentation</strong> (6 hours)</h3>
<p><strong>Files to Update</strong>:</p>
<ol>
<li><strong><code>.claude/CLAUDE.md</code></strong> (1h)</li>
<li>Update Team D section</li>
<li>Add annotation layer rules</li>
<li>
<p>Examples of app vs. core layer</p>
</li>
<li>
<p><strong><code>README.md</code></strong> (1h)</p>
</li>
<li>Add FraiseQL annotation section</li>
<li>
<p>Explain two-layer architecture</p>
</li>
<li>
<p><strong><code>docs/teams/TEAM_D_PHASED_IMPLEMENTATION_PLAN.md</code></strong> (1h)</p>
</li>
<li>Add annotation separation notes</li>
<li>
<p>Update examples</p>
</li>
<li>
<p><strong>Create new guide</strong> (3h)
   ```bash
   # Create comprehensive guide
   vim docs/guides/FRAISEQL_ANNOTATION_LAYERS.md</p>
</li>
</ol>
<p># Contents:
   # - When to use @fraiseql:mutation (app layer only!)
   # - When NOT to use it (core layer)
   # - Examples of both patterns
   # - Troubleshooting guide
   ```</p>
<hr />
<h2 id="this-weeks-schedule">üìÖ This Week's Schedule</h2>
<p><strong>Monday (Today)</strong>: Annotation Cleanup - Code
- Update <code>mutation_annotator.py</code> (2h)
- Regenerate SQL files (1h)
- Manual cleanup (30min)
- Testing (30min)</p>
<p><strong>Tuesday</strong>: Annotation Cleanup - Verification
- Comprehensive testing (2h)
- Fix any issues found (2h)</p>
<p><strong>Wednesday</strong>: Documentation
- Update <code>.claude/CLAUDE.md</code> (1h)
- Update <code>README.md</code> (1h)
- Update Team D docs (1h)
- Start annotation layers guide (3h)</p>
<p><strong>Thursday</strong>: Documentation + Buffer
- Finish annotation layers guide
- Integration testing
- Fix any discovered issues</p>
<p><strong>Friday</strong>: Wrap Up Week
- Final testing
- Document known issues
- Prepare for Week 2 (frontend codegen)</p>
<hr />
<h2 id="progress-tracking">üìä Progress Tracking</h2>
<h3 id="current-state-70">Current State (70%)</h3>
<pre><code>‚úÖ Phase 1: Cleanup &amp; Confiture Integration (DONE)
‚úÖ Phase 2: Dual-Mode Output (DONE)
‚úÖ Phase 3.1: Confiture Integration - Install (DONE)
‚úÖ Phase 3.2: Confiture Integration - Structure (DONE)
üîÑ Phase 3.3: FraiseQL Annotation Cleanup (IN PROGRESS)
‚è∏Ô∏è  Phase 3.4: Documentation Updates (NEXT)
‚è∏Ô∏è  Phase 4: Frontend Code Generation (WEEK 2)
</code></pre>
<h3 id="target-state-95">Target State (95%)</h3>
<pre><code>‚úÖ Phase 1: Cleanup &amp; Confiture Integration
‚úÖ Phase 2: Dual-Mode Output
‚úÖ Phase 3: Confiture Integration (all sub-phases)
‚úÖ Phase 4: Frontend Code Generation
‚úÖ Final QA &amp; Polish
</code></pre>
<hr />
<h2 id="success-criteria-for-this-week">üéØ Success Criteria for This Week</h2>
<p><strong>By Friday, should have</strong>:
- [ ] No core functions with <code>@fraiseql:mutation</code> annotations
- [ ] All app functions still have annotations
- [ ] <code>mutation_annotator.py</code> updated to handle both layers correctly
- [ ] All documentation updated
- [ ] New annotation layers guide created
- [ ] All tests passing
- [ ] Team E at <strong>80% complete</strong> (ready for frontend codegen next week)</p>
<hr />
<h2 id="how-to-verify-everything-works">üîç How to Verify Everything Works</h2>
<h3 id="test-1-annotation-separation"><strong>Test 1: Annotation Separation</strong></h3>
<pre><code class="language-bash"># Should find ZERO core functions with annotations
grep -r &quot;@fraiseql:mutation&quot; db/schema/30_functions/ | grep &quot;crm\.\|projects\.\|catalog\.&quot; | wc -l
# Expected: 0

# Should find ALL app functions with annotations
grep -r &quot;@fraiseql:mutation&quot; db/schema/30_functions/ | grep &quot;app\.&quot; | wc -l
# Expected: Number of actions across all entities
</code></pre>
<h3 id="test-2-code-quality"><strong>Test 2: Code Quality</strong></h3>
<pre><code class="language-bash"># Run all tests
uv run pytest tests/ -v

# Type checking
uv run mypy src/generators/fraiseql/

# Linting
uv run ruff check src/generators/fraiseql/
</code></pre>
<h3 id="test-3-end-to-end"><strong>Test 3: End-to-End</strong></h3>
<pre><code class="language-bash"># Generate from SpecQL
python -m src.cli.generate entities/examples/contact_lightweight.yaml

# Check output structure
ls -R db/schema/

# Verify no regressions
git diff db/schema/ | grep &quot;@fraiseql:mutation&quot;
</code></pre>
<hr />
<h2 id="key-reference-documents">üìö Key Reference Documents</h2>
<p><strong>Created Today</strong>:
1. <code>TEAM_E_REVISED_PLAN_POST_CONFITURE_V2.md</code> - Complete updated plan
2. <code>CLEANUP_OPPORTUNITY_POST_CONFITURE.md</code> - What to remove/simplify
3. <code>EXECUTIVE_SUMMARY_CONFITURE_INTEGRATION.md</code> - ROI analysis
4. <code>TEAM_E_NEXT_ACTIONS.md</code> - This document</p>
<p><strong>Existing References</strong>:
1. <code>docs/TICKET_REMOVE_FRAISEQL_ANNOTATIONS_FROM_CORE_FUNCTIONS.md</code> - The issue to fix
2. <code>docs/teams/TEAM_E_CURRENT_STATE.md</code> - Team E status (update to 70%)
3. <code>docs/teams/TEAM_D_PHASED_IMPLEMENTATION_PLAN.md</code> - Team D (needs update)</p>
<hr />
<h2 id="pro-tips">üí° Pro Tips</h2>
<h3 id="for-annotation-cleanup"><strong>For Annotation Cleanup</strong>:</h3>
<ul>
<li>Don't manually edit every file - fix the generator, then regenerate</li>
<li>Test on one entity first (Contact) before regenerating all</li>
<li>Keep a backup before regenerating: <code>cp -r db/schema db/schema.backup</code></li>
</ul>
<h3 id="for-documentation"><strong>For Documentation</strong>:</h3>
<ul>
<li>Use concrete examples (actual SQL from generated files)</li>
<li>Include "before/after" comparisons</li>
<li>Add troubleshooting section ("Why am I seeing X?")</li>
</ul>
<h3 id="for-testing"><strong>For Testing</strong>:</h3>
<ul>
<li>Test the unhappy paths too (what if annotation is malformed?)</li>
<li>Verify FraiseQL introspection works (if you have FraiseQL available)</li>
<li>Check that generated GraphQL schema only includes app layer functions</li>
</ul>
<hr />
<h2 id="potential-issues-solutions">üö® Potential Issues &amp; Solutions</h2>
<h3 id="issue-1-regenerating-overwrites-manual-changes"><strong>Issue 1</strong>: Regenerating overwrites manual changes</h3>
<p><strong>Solution</strong>: Make all changes in generators, not in generated SQL</p>
<h3 id="issue-2-some-core-functions-need-different-annotations"><strong>Issue 2</strong>: Some core functions need different annotations</h3>
<p><strong>Solution</strong>: Use conditional logic in <code>mutation_annotator.py</code> based on schema name</p>
<h3 id="issue-3-tests-fail-after-annotation-changes"><strong>Issue 3</strong>: Tests fail after annotation changes</h3>
<p><strong>Solution</strong>: Tests shouldn't depend on specific comment formats - if they do, update tests</p>
<h3 id="issue-4-fraiseql-introspects-core-functions"><strong>Issue 4</strong>: FraiseQL introspects core functions</h3>
<p><strong>Solution</strong>: This is the whole point of the fix! After cleanup, FraiseQL should only find app layer</p>
<hr />
<h2 id="quick-checklist-for-today">‚úÖ Quick Checklist for Today</h2>
<p><strong>Morning</strong> (4h):
- [ ] Read the ticket: <code>docs/TICKET_REMOVE_FRAISEQL_ANNOTATIONS_FROM_CORE_FUNCTIONS.md</code>
- [ ] Open <code>src/generators/fraiseql/mutation_annotator.py</code>
- [ ] Implement two-comment logic (app vs. core)
- [ ] Test on Contact entity first</p>
<p><strong>Afternoon</strong> (4h):
- [ ] Regenerate all entities
- [ ] Manual cleanup if needed
- [ ] Run tests
- [ ] Commit changes
- [ ] Update status: Team E ‚Üí 75% complete</p>
<hr />
<p><strong>Status</strong>: üü¢ READY TO START
<strong>Priority</strong>: HIGH (blocking FraiseQL integration correctness)
<strong>Estimated Time</strong>: 4 hours for annotation fix, 6 hours for docs
<strong>Next Review</strong>: Tomorrow EOD (verify annotation cleanup complete)</p>
<hr />
<p><em>Last Updated</em>: November 9, 2025
<em>For</em>: Team E Development
<em>Created By</em>: Claude Code</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
